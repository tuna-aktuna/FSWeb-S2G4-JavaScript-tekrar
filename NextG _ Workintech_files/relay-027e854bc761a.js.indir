(()=>{"use strict";const e=new Map;class t{getItem(t){const n=String(t);return e.has(t)?String(e.get(n)):null}setItem(t,n){e.set(String(t),String(n))}removeItem(t){e.delete(t)}clear(){e.clear()}key(t){if(0===arguments.length)throw new TypeError("Failed to execute 'key' on 'Storage': 1 argument required, but only 0 present.");return Array.from(e.keys())[t]}get length(){return e.size}}let n,r=!1;try{n=localStorage,r=!0}catch{const e=new t;n=new Proxy(e,{set:(n,r,o)=>(t.prototype.hasOwnProperty(r)?e[r]=o:e.setItem(r,o),!0),get:(n,r)=>t.prototype.hasOwnProperty(r)?e[r]:null!=e.getItem(r)?e.getItem(r):void 0})}function o(){window.parent.postMessage({type:"RELAY_READY"},window.EURL)}try{!function(){function e(){return Date.now()/1e3|0}if(n.setItem("editorHasEmittedBundle","false"),n.setItem("editorLastConnected",`${e()}`),setInterval((function(){n.setItem("editorLastConnected",`${e()}`)}),2e3),"serviceWorker"in navigator){var t={enabled:!0};window.onmessage=function(e){var r;"PREVIEW_INSTANTIATE_BUNDLE"===e.data.type&&n.setItem("editorHasEmittedBundle","true"),t.enabled&&(r=e.data,navigator.serviceWorker.getRegistrations().then((e=>{e.forEach((e=>{e.active&&e.active.postMessage({type:"RELAY_TO_PREVIEWS",payload:r})}))})))},navigator.serviceWorker.addEventListener("message",(e=>{const{type:n,payload:r}=e.data;if("PREVIEW_TO_RELAY"===n){const e=r;"EDITOR_CONNECTED"===e.type&&(t.enabled=!1),t.enabled&&window.parent.postMessage(e,"*")}}))}}()}catch(e){window.parent.postMessage({type:"RELAY_FAILED"},window.EURL)}var a;"serviceWorker"in navigator?(a="_sw_.js",new Promise(((e,t)=>{if(!("serviceWorker"in navigator))return t("This browser doesn't support Service Workers.");window.addEventListener("load",(function(){navigator.serviceWorker.register(a).then((function(){navigator.serviceWorker.ready.then((t=>{e(t)}))}),(function(e){return t(e)}))}))}))).then((()=>{!function(e){const t=t=>{"FETCH_REQUEST"===t.data.type&&e(t.data,t.ports[0])};navigator.serviceWorker.addEventListener("message",t)}(((e,t)=>{window.parent.postMessage(e,"*",[t])})),o()})):o(),window.addEventListener("unload",(function(){n.setItem("editorLastConnected","0"),n.setItem("editorHasEmittedBundle","false")}))})();